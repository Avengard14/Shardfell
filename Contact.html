<!DOCTYPE html>
<html lang="fr">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Shardfell - Hall des Aventuriers</title>
    <!-- Bootstrap 5 CSS (uniquement pour le responsive) -->
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <!-- Fonts -->
    <link
      href="https://fonts.googleapis.com/css2?family=Marko+One&family=Inter:wght@300;400;500;600;700&family=Raleway:wght@400;500;600;700&display=swap"
      rel="stylesheet"
    />
    <!-- Font Awesome -->
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
    />
    <!-- CSS personnalis√© -->
    <link rel="stylesheet" href="css/style.css" />
     <link rel="shortcut icon" href="image/Logo-(1).png" />
  </head>
  <body>
    <!-- Banni√®re -->
    <div class="banner">
      <div class="banner-text">
        üèπ Bienvenue dans l'univers l√©gendaire de Shardfell üèπ
      </div>
    </div>

    <!-- Navigation avec Bootstrap -->
        <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
      <div class="container">
        <a class="navbar-brand d-flex align-items-center" href="#">
          <img
            src="image/Logo-(1).png"
            alt="Logo Shardfell"
            class="logo-icon me-2"
          />
          <span class="logo-text">Shardfell</span>
        </a>
        <button
          class="navbar-toggler"
          type="button"
          data-bs-toggle="collapse"
          data-bs-target="#navbarNav"
          aria-controls="navbarNav"
          aria-expanded="false"
          aria-label="Toggle navigation"
        >
          <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarNav">
          <ul class="navbar-nav ms-auto">
            <li class="nav-item">
              <a
                class="nav-link asymmetric-btn hall active"
                aria-current="page"
                href="index.html"
                >Hall</a
              >
            </li>
            <li class="nav-item">
              <a class="nav-link asymmetric-btn menu-item" href="Le_Jeu.html"
                >Le Jeu</a
              >
            </li>
            <li class="nav-item">
              <a class="nav-link asymmetric-btn menu-item" href="A_propos.html"
                >√Ä propos</a
              >
            </li>
            <li class="nav-item">
              <a class="nav-link asymmetric-btn cart-btn" href="Contact.html"
                >Nous contacter</a
              >
            </li>
            <li class="nav-item">
              <a class="nav-link asymmetric-btn cart-btn" href="produit.html"
                >Boutique</a
              >
            </li>
          </ul>
        </div>
      </div>
    </nav>

    <!-- Contenu principal -->
    <main>
      <div class="container">
        <!-- Hero Section -->
        <section class="contact-hero">
          <h1 class="contact-title">Contactez-nous</h1>
          <p class="contact-subtitle">
            Que votre message soit une qu√™te, une suggestion ou une simple
            salutation, nous sommes l√† pour vous √©couter
          </p>
        </section>

        <!-- Formulaire de contact -->
        <div class="contact-form-container">
          <!-- Coins d√©coratifs -->
          <div class="corner corner-top-left">‚ú¶</div>
          <div class="corner corner-top-right">‚úß</div>
          <div class="corner corner-bottom-left">‚ùà</div>
          <div class="corner corner-bottom-right">‚ú¶</div>

          <div class="form-surface">
            <div class="form-header">
              <h2 class="form-title">Parchemin de Contact</h2>
              <p class="form-subtitle">
                R√©digez votre message aux ma√Ætres de Shardfell
              </p>
            </div>

            <form id="contactForm"  action="https://formspree.io/f/xkgbkool" method="POST">
              <!-- Nom -->
              <div class="form-group">
                <label for="name" class="form-label"
                  >Nom <span class="required">*</span></label
                >
                <input
                  type="text"
                  id="name"
                  name="name"
                  class="form-input"
                  required
                />
                <div class="validation-message" id="nameMessage"></div>
              </div>

              <!-- Email -->
              <div class="form-group">
                <label for="email" class="form-label"
                  >Adresse de messagerie <span class="required">*</span></label
                >
                <input
                  type="email"
                  id="email"
                  name="email"
                  class="form-input"
                  required
                />
                <div class="validation-message" id="emailMessage"></div>
              </div>

              <!-- Message -->
              <div class="form-group">
                <label for="message" class="form-label"
                  >Message <span class="required">*</span></label
                >
                <textarea
                  id="message"
                  name="message"
                  class="form-textarea"
                  required
                  placeholder="Racontez-nous votre histoire, posez vos questions ou partagez vos id√©es..."
                ></textarea>
                <div class="char-counter" id="charCounter">
                  0 / 1000 caract√®res
                </div>
                <div class="validation-message" id="messageMessage"></div>
              </div>

              <!-- Bouton d'envoi -->
              <button type="submit" class="form-submit" id="submitBtn">
                <i class="fas fa-paper-plane"></i> Envoyer le message
              </button>
            </form>

            <!-- Message de succ√®s (masqu√© par d√©faut, g√©r√© par JS si tu veux l'utiliser) -->
            <div class="success-message" id="successMessage" hidden>
              <div class="success-icon">‚ú®</div>
              <div class="success-title">Message envoy√© !</div>
              <div class="success-text">
                Votre parchemin a √©t√© transmis aux gardiens de Shardfell. Nous
                vous r√©pondrons dans les plus brefs d√©lais. Que l'aventure
                continue !
              </div>
            </div>
          </div>
        </div>
      </div>
    </main>

    <!-- Footer avec Bootstrap -->
    <footer class="bg-dark text-white py-4">
      <div class="container-fluid">
        <div class="footer-banner text-center mb-4">
          <div class="banner-text">
            ‚öîÔ∏è L'aventure vous attend dans les terres de Shardfell ‚öîÔ∏è
          </div>
        </div>

        <div class="row">
          <div class="col-md-4 text-center text-md-start mb-3 mb-md-0">
            <div
              class="footer-logo d-flex align-items-center justify-content-center justify-content-md-start"
            >
              <img
                src="image/Logo-(1).png"
                alt="Logo Shardfell"
                class="footer-logo-icon me-2"
              />
              <span class="footer-logo-text">Shardfell</span>
            </div>
          </div>

          <div class="col-md-4 text-center mb-3 mb-md-0">
            <div class="social-icons d-flex justify-content-center gap-3">
              <a
                href="https://www.facebook.com"
                title="Facebook"
                aria-label="Page Facebook"
                class="text-white"
                ><i class="fab fa-facebook-f"></i
              ></a>
              <a
                href="https://x.com/home"
                title="Twitter"
                aria-label="Compte Twitter"
                class="text-white"
                ><i class="fab fa-twitter"></i
              ></a>
              <a
                href="https://discord.gg"
                title="Discord"
                aria-label="Serveur Discord"
                class="text-white"
                ><i class="fab fa-discord"></i
              ></a>
              <a
                href="https://www.youtube.com"
                title="YouTube"
                aria-label="Cha√Æne YouTube"
                class="text-white"
                ><i class="fab fa-youtube"></i
              ></a>
            </div>
          </div>

          <div class="col-md-4 text-center text-md-end">
            <div
              class="footer-links d-flex flex-column flex-md-row justify-content-center justify-content-md-end gap-3"
            >
             <a href="condition.html" class="text-white">Conditions d'utilisation</a>
              <a href="politique.html" class="text-white">Politique de confidentialit√©</a>
            </div>
          </div>
        </div>

        <div class="row mt-3">
          <div class="col-12 text-center">
            <div class="copyright">¬© 2025 Shardfell - Tous droits r√©serv√©s</div>
          </div>
        </div>

        <!-- (Optionnel) Modales statiques non utilis√©es par ton JS actuel -->
        <div id="successModal" class="modal" hidden>
          <div class="modal-content">
            <h3>‚úÖ Message envoy√© avec succ√®s !</h3>
            <p>
              Merci pour votre message. Nous vous r√©pondrons dans les plus brefs
              d√©lais.
            </p>
            <div class="modal-buttons"><button id="closeModal">OK</button></div>
          </div>
        </div>

        <div id="errorModal" class="modal" hidden>
          <div class="modal-content">
            <h3>‚ùå Erreur</h3>
            <p>
              Veuillez remplir correctement tous les champs avant d'envoyer le
              message.
            </p>
            <div class="modal-buttons">
              <button id="closeErrorModal">OK</button>
            </div>
          </div>
        </div>
      </div>
    </footer>

    <!-- JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>

    <!-- Ton script (voir correctifs ci-dessous) -->
    <script>
      document.addEventListener("DOMContentLoaded", () => {
        const CONFIG = {
          name: {
            minLength: 2,
            maxLength: 50,
            pattern: /^[a-zA-Z√Ä-√ø\s\-']{2,}$/,
          },
          email: { pattern: /^[^\s@]+@[^\s@]+\.[^\s@]+$/ },
          message: { minLength: 10, maxLength: 1000, minWords: 3 },
        };

        // DOM
        const form = document.getElementById("contactForm");
        const nameInput = document.getElementById("name");
        const emailInput = document.getElementById("email");
        const messageInput = document.getElementById("message");
        const charCounter = document.getElementById("charCounter");
        const submitBtn = document.getElementById("submitBtn");

        const nameMessage = document.getElementById("nameMessage");
        const emailMessage = document.getElementById("emailMessage");
        const messageMessage = document.getElementById("messageMessage");

        if (
          !form ||
          !nameInput ||
          !emailInput ||
          !messageInput ||
          !charCounter ||
          !submitBtn
        ) {
          console.warn(
            "Contact script : √©l√©ments manquants (v√©rifie les IDs)."
          );
          return;
        }

        // util
        function esc(s) {
          return String(s).replace(
            /[&<>"']/g,
            (c) =>
              ({
                "&": "&amp;",
                "<": "&lt;",
                ">": "&gt;",
                '"': "&quot;",
                "'": "&#39;",
              }[c])
          );
        }

        function showValidationMessage(el, message, type = "error") {
          if (!el) return;
          const icon =
            type === "error" ? "‚ùå" : type === "success" ? "‚úÖ" : "‚ö†Ô∏è";
          el.innerHTML = `<span>${icon}</span> ${esc(message)}`;
          el.className = `validation-message ${type} show`;
          el.style.display = "block";
        }

        function hideValidationMessage(el) {
          if (!el) return;
          el.innerHTML = "";
          el.classList.remove("show");
          el.style.display = "none";
        }

        // validations (reprennent ta logique)
        function validateName(value) {
          const v = (value || "").trim();
          const input = nameInput;
          input.classList.remove("valid", "error", "warning");

          if (!v) {
            input.classList.add("error");
            showValidationMessage(nameMessage, "Le nom est requis", "error");
            return false;
          }
          if (v.length < CONFIG.name.minLength) {
            input.classList.add("error");
            showValidationMessage(
              nameMessage,
              `Le nom doit contenir au moins ${CONFIG.name.minLength} caract√®res`,
              "error"
            );
            return false;
          }
          if (v.length > CONFIG.name.maxLength) {
            input.classList.add("error");
            showValidationMessage(
              nameMessage,
              `Le nom ne peut pas d√©passer ${CONFIG.name.maxLength} caract√®res`,
              "error"
            );
            return false;
          }
          if (!CONFIG.name.pattern.test(v)) {
            input.classList.add("error");
            showValidationMessage(
              nameMessage,
              "Le nom contient des caract√®res non autoris√©s",
              "error"
            );
            return false;
          }

          const suspiciousWords = ["test", "123", "azerty", "qwerty", "admin"];
          if (suspiciousWords.some((w) => v.toLowerCase().includes(w))) {
            input.classList.add("warning");
            showValidationMessage(
              nameMessage,
              "Ce nom semble peu authentique",
              "warning"
            );
            return true;
          }

          input.classList.add("valid");
          showValidationMessage(nameMessage, "Nom valide", "success");
          return true;
        }

        function validateEmail(value) {
          const v = (value || "").trim();
          const input = emailInput;
          input.classList.remove("valid", "error", "warning");

          if (!v) {
            input.classList.add("error");
            showValidationMessage(
              emailMessage,
              "L'adresse email est requise",
              "error"
            );
            return false;
          }
          if (!CONFIG.email.pattern.test(v)) {
            input.classList.add("error");
            showValidationMessage(
              emailMessage,
              "Format d'email invalide",
              "error"
            );
            return false;
          }

          const suspiciousDomains = [
            "tempmail",
            "10minutemail",
            "guerrillamail",
          ];
          if (suspiciousDomains.some((d) => v.toLowerCase().includes(d))) {
            input.classList.add("warning");
            showValidationMessage(
              emailMessage,
              "Adresse email temporaire d√©tect√©e",
              "warning"
            );
            return true;
          }

          input.classList.add("valid");
          showValidationMessage(emailMessage, "Email valide", "success");
          return true;
        }

        function validateMessage(value) {
          const v = (value || "").trim();
          const input = messageInput;
          input.classList.remove("valid", "error", "warning");

          const words = v
            ? v.split(/\s+/).filter((w) => w.length > 0).length
            : 0;

          if (!v) {
            input.classList.add("error");
            showValidationMessage(
              messageMessage,
              "Le message est requis",
              "error"
            );
            return false;
          }
          if (v.length < CONFIG.message.minLength) {
            input.classList.add("error");
            showValidationMessage(
              messageMessage,
              `Le message doit contenir au moins ${CONFIG.message.minLength} caract√®res`,
              "error"
            );
            return false;
          }
          if (v.length > CONFIG.message.maxLength) {
            input.classList.add("error");
            showValidationMessage(
              messageMessage,
              `Le message ne peut pas d√©passer ${CONFIG.message.maxLength} caract√®res`,
              "error"
            );
            return false;
          }
          if (words < CONFIG.message.minWords) {
            input.classList.add("error");
            showValidationMessage(
              messageMessage,
              `Le message doit contenir au moins ${CONFIG.message.minWords} mots`,
              "error"
            );
            return false;
          }

          const spamWords = [
            "gratuit",
            "urgent",
            "cliquez",
            "promotion",
            "offre",
          ];
          const spamCount = spamWords.filter((w) =>
            v.toLowerCase().includes(w)
          ).length;
          if (spamCount > 2) {
            input.classList.add("warning");
            showValidationMessage(
              messageMessage,
              "Ce message pourrait √™tre consid√©r√© comme du spam",
              "warning"
            );
            return true;
          }

          input.classList.add("valid");
          showValidationMessage(messageMessage, "Message valide", "success");
          return true;
        }

        // compteur
        function updateCharCounter() {
          const len = messageInput.value.length;
          const max = CONFIG.message.maxLength;
          charCounter.textContent = `${len} / ${max} caract√®res`;
          if (len > max) {
            charCounter.classList.add("error");
            charCounter.classList.remove("warning");
            charCounter.style.color = "#c62828";
          } else if (len > max * 0.9) {
            charCounter.classList.add("warning");
            charCounter.classList.remove("error");
            charCounter.style.color = "#ff9800";
          } else {
            charCounter.classList.remove("warning", "error");
            charCounter.style.color = "";
          }
        }
        updateCharCounter();

        // √©v√©nements
        nameInput.addEventListener("blur", () => validateName(nameInput.value));
        nameInput.addEventListener("input", () => {
          if (
            nameInput.classList.contains("error") ||
            nameInput.classList.contains("valid")
          )
            validateName(nameInput.value);
        });

        emailInput.addEventListener("blur", () =>
          validateEmail(emailInput.value)
        );
        emailInput.addEventListener("input", () => {
          if (
            emailInput.classList.contains("error") ||
            emailInput.classList.contains("valid")
          )
            validateEmail(emailInput.value);
        });

        messageInput.addEventListener("input", () => {
          updateCharCounter();
          if (
            messageInput.classList.contains("error") ||
            messageInput.classList.contains("valid")
          )
            validateMessage(messageInput.value);
        });
        messageInput.addEventListener("blur", () =>
          validateMessage(messageInput.value)
        );

        // POPUP (cr√©ation d'un overlay propre)
        function showPopup(type, title, message) {
          if (document.getElementById("sf-popup-overlay")) return;
          const overlay = document.createElement("div");
          overlay.id = "sf-popup-overlay";
          overlay.setAttribute("role", "dialog");
          overlay.setAttribute("aria-modal", "true");
          Object.assign(overlay.style, {
            position: "fixed",
            inset: "0",
            display: "flex",
            alignItems: "center",
            justifyContent: "center",
            background: "rgba(0,0,0,0.45)",
            zIndex: "99999",
            padding: "20px",
          });

          const box = document.createElement("div");
          box.setAttribute("role", "document");
          Object.assign(box.style, {
            background: "#fff",
            color: "#111",
            padding: "1.25rem",
            borderRadius: "10px",
            maxWidth: "520px",
            width: "100%",
            boxShadow: "0 12px 40px rgba(0,0,0,0.3)",
            textAlign: "center",
            lineHeight: "1.4",
          });

          const icon = type === "success" ? "‚úÖ" : "‚ùå";
          const titleHtml = `<div style="font-size:1.05rem; margin-bottom:.4rem;"><strong>${esc(
            title
          )}</strong></div>`;
          const msgHtml = `<div style="margin-bottom:1rem;">${esc(
            message
          )}</div>`;

          box.innerHTML = `<div style="font-size:1.8rem;margin-bottom:.35rem">${icon}</div>${titleHtml}${msgHtml}`;

          const ok = document.createElement("button");
          ok.type = "button";
          ok.textContent = "OK";
          Object.assign(ok.style, {
            padding: ".5rem 1rem",
            borderRadius: "6px",
            cursor: "pointer",
            border: "none",
            background: "#2e7d32",
            color: "#fff",
          });
          if (type !== "success") {
            ok.style.background = "#c62828";
          }
          ok.addEventListener("click", close);
          box.appendChild(ok);

          overlay.appendChild(box);
          document.body.appendChild(overlay);

          // accessibilit√© & fermeture
          const prevOverflow = document.body.style.overflow;
          document.body.style.overflow = "hidden";
          ok.focus();

          function onKey(e) {
            if (e.key === "Escape") close();
          }
          function onOverlayClick(e) {
            if (e.target === overlay) close();
          }

          document.addEventListener("keydown", onKey);
          overlay.addEventListener("click", onOverlayClick);

          function close() {
            overlay.remove();
            document.body.style.overflow = prevOverflow || "";
            document.removeEventListener("keydown", onKey);
            overlay.removeEventListener("click", onOverlayClick);

            // reset du formulaire √† la fermeture (tu peux modifier si tu pr√©f√®res le reset imm√©diat)
            form.reset();
            updateCharCounter();
            [nameInput, emailInput, messageInput].forEach((i) =>
              i.classList.remove("valid", "error", "warning")
            );
            [nameMessage, emailMessage, messageMessage].forEach(
              hideValidationMessage
            );
            submitBtn.disabled = false;
            submitBtn.innerHTML =
              '<i class="fas fa-paper-plane"></i> Envoyer le message';
            submitBtn.focus();
          }
        }

        form.addEventListener("submit", async (e) => {
  e.preventDefault();

  const isNameValid = validateName(nameInput.value);
  const isEmailValid = validateEmail(emailInput.value);
  const isMessageValid = validateMessage(messageInput.value);

  if (!isNameValid || !isEmailValid || !isMessageValid) {
    submitBtn.textContent = "‚ùå Veuillez corriger les erreurs";
    setTimeout(() => {
      submitBtn.innerHTML =
        '<i class="fas fa-paper-plane"></i> Envoyer le message';
    }, 1800);
    return;
  }

  submitBtn.disabled = true;
  submitBtn.textContent = "‚ú® Envoi en cours...";

  try {
    // üëâ Envoi r√©el vers Formspree
    const response = await fetch("https://formspree.io/f/xkgbkool", {
      method: "POST",
      body: new FormData(form),
      headers: { Accept: "application/json" },
    });

    if (response.ok) {
      showPopup(
        "success",
        "Message envoy√© !",
        "Ton message a bien √©t√© transmis aux gardiens de Shardfell. Nous te r√©pondrons bient√¥t."
      );
    } else {
      showPopup(
        "error",
        "Erreur",
        "Une erreur est survenue lors de l'envoi. R√©essaie plus tard."
      );
      submitBtn.disabled = false;
      submitBtn.innerHTML =
        '<i class="fas fa-paper-plane"></i> Envoyer le message';
    }
  } catch (err) {
    console.error(err);
    showPopup(
      "error",
      "Erreur",
      "Impossible de contacter le serveur. V√©rifie ta connexion."
    );
    submitBtn.disabled = false;
    submitBtn.innerHTML =
      '<i class="fas fa-paper-plane"></i> Envoyer le message';
          }
        });
      });
    </script>
  </body>
</html>

